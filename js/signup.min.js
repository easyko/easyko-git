$(function(){function e(){$(window).width()>720?$(".form-text-prefix").each(function(){var e=$(this).next();$(e).width($(e).data("width")-$(this).width()-5)}):$(".form-text-prefix").each(function(){var e=$(this).next();$(e).width($("input[name=usrName]").width()-$(this).width()-5),$("input[name=usrId]").css("left",$(this).width()+5+"px")})}function t(e,t,a){$(e).find("input").not(":hidden").each(function(){r(this,t,a)}),i()}function i(){var e=$(".errFocus .form-unit-error").first();e.length>0&&$("html,body").animate({scrollTop:$(e).offset().top-50},"medium",function(){})}function r(e,t,i){if(!($(e).closest(".form-group").find(".active").length>0)){var r=n(e,t,i);"skip"!==r&&(void 0!==r?c(r,e):$(e).closest(".form-group").find(".okay").addClass("active"))}}function a(e,t,i,r){h++,$.ajax({url:e,type:"post",dataType:"json",data:t}).done(function(e){if(e.error){var t=["errorInfo",e.error];c(t,i)}else $(i).is(":focus")||c("okay",i),$(r).is(":focus")||c("okay",r)}).always(function(){h--})}function n(e,t,i){var r=$(e).val(),n=$(e).closest(".form");if(void 0===$(e).attr("required")&&void 0===$(e).attr("match")&&void 0===$(e).attr("equal")&&void 0===$(e).attr("diff"))return"skip";if("required"===$(e).attr("required")&&(""===r||"checkbox"===$(e).attr("type")&&"checked"!==$(e).attr("checked")))return t?"skip":"required";var o=$(e).attr("match"),l=$(e).attr("name");if(void 0!==o){if(""===r)return"skip";var u=[];if(u.usrMp=new RegExp(/^1[0-9]{10}$/),u.email=new RegExp(/^([a-zA-Z0-9_\.\-]+)(@{1})([a-zA-Z0-9_\.\-]+)(\.[a-zA-Z0-9]{1,3})$/),u.usrId=new RegExp(/^[0-9a-zA-Z_.@-]{6,25}$/),u.userPw=new RegExp(/^.{6,16}$/),u.smsCode=new RegExp(/^0?\d{6}$/),u.bankCard=new RegExp(/^.{8,32}$/),"userPw"===o&&s(e),!r.match(u[o])||"certId"===o&&"certId"===l&&!d(r).isTrue)return"match";var h=$("#merCustId").val();if(!i){if("usrId"===o)return a("/muser/reg/checkLoginId",{loginId:$("#usrPrefix").val()+r,merCustId:h},e),"checking";if("certId"===o){var p=$("input[name=usrName]").val(),f=$("input[name=certId]").val();return $("input[name=certId]").closest(".form-group").removeClass("active"),$("input[name=usrName]").closest(".form-group").removeClass("active"),""!==p&&""!==f?(a("/muser/reg/checkCertId",{usrName:p,certId:f,merCustId:h,certType:$("#certType").val()},$("input[name=certId]"),$("input[name=usrName]")),c("checking",$("input[name=certId]")),"skip"):(""===p&&c("required",$("input[name=usrName]")),"skip")}if("usrMp"===o)return a("/muser/ajax/checkUsrMp",{usrMp:r,merCustId:h},e),"checking"}}if(void 0!==$(e).attr("equal")){var m=$(n).find("input[name="+$(e).attr("equal")+"]"),v=$(m).val(),g=$(e).closest(".form-group").find(".equal"),k=$(n).find(m).closest(".form-group").find(".equal"),y=$(e).closest(".form-group").find(".okay"),C=$(m).closest(".form-group").find(".okay");if(""!==v&&""!==r)if(r!==v){if(0!==g.length)return y.removeClass("active"),"equal";C.removeClass("active"),c("equal",m)}else 0===g.length&&(k.removeClass("active"),m.removeClass("form-unit-error"),C.addClass("active"));else if(1===g.length)return"skip"}if(void 0!==$(e).attr("diff")){var w=$(n).find("input[name="+$(e).attr("diff")+"]"),b=$(w).val(),g=$(e).closest(".form-group").find(".diff"),x=$(n).find(w).closest(".form-group").find(".diff"),y=$(e).closest(".form-group").find(".okay"),I=$(w).closest(".form-group").find(".okay");if(""!==b&&""!==r)if(r===b){if(0!==g.length)return y.removeClass("active"),"diff";I.removeClass("active"),c("diff",w)}else 0===g.length&&($(x).removeClass("active"),$(w).removeClass("form-unit-error"),I.addClass("active"))}}function s(e){var t=$(e).val(),i=l(t),r=$(e).closest(".form-group"),a=$(r).find(".pw-secure i"),n=$(r).find(".pw-secure b");n.css("background-color","#e4e7ea"),0===i?($(a).removeClass().addClass("pw-secure-none"),$(r).find(".pw-secure-text").text("无").css("color","#666")):1===i?($(a).removeClass().addClass("pw-secure-low"),$(r).find(".pw-secure-text").text("低").css("color","#dc7018"),$(n).last().css("background-color","#dc7018")):2===i?($(a).removeClass().addClass("pw-secure-med"),$(r).find(".pw-secure-text").text("中").css("color","#ff9c00"),$(n).parent().find("b:gt(1)").css("background-color","#ff9c00")):3===i&&($(a).removeClass().addClass("pw-secure-high"),$(r).find(".pw-secure-text").text("高").css("color","#009900"),$(n).css("background-color","#009900"))}function o(e){if(console.log("check="+h),h>0)return alert("正在校验请稍后重新点击确定按钮"),void 0;t(e,void 0,!0);var r=$(e).find(".error.active").length;if(r>0)return i(),void 0;if(0===r){$(e).find(".btn-primary").removeClass("btn-primary").addClass("btn-disabled");var a=$("input[name=usrId]");a.length>0&&$(e).find("input[name=loginId]").val("wwwj_"+$(e).find("input[name=usrId]").val()),e.submit()}}function c(e,t){var i;"object"==typeof e?(i=e[0],$(t).closest(".form-group").find("."+i+" p").text(e[1])):i=e,"checking"!==i&&"okay"!==i&&$(t).addClass("form-unit-error"),$(t).closest(".form-group").find("."+i).addClass("active")}function l(e){var t=0,i=0,r=0,a=new RegExp("[A-Z]"),n=new RegExp("[a-z]"),s=new RegExp("[0-9]");t=e.match(a)?1:0,i=e.match(n)?1:0,r=e.match(s)?1:0;var o=0;return e.length>=6&&(o=t+i+r),o}function d(e){var t={isTrue:!1,year:null,month:null,day:null,isMale:!1,isFemale:!1};if(!e&&15!=e.length&&18!=e.length)return t.isTrue=!1,t;if(15==e.length){var i=e.substring(6,8),r=e.substring(8,10),a=e.substring(10,12),n=e.substring(14,15),s=new Date(i,parseFloat(r)-1,parseFloat(a));return s.getYear()!=parseFloat(i)||s.getMonth()!=parseFloat(r)-1||s.getDate()!=parseFloat(a)?t.isTrue=!1:(t.isTrue=!0,t.year=s.getFullYear(),t.month=s.getMonth()+1,t.day=s.getDate(),0==n%2?(t.isFemale=!0,t.isMale=!1):(t.isFemale=!1,t.isMale=!0)),t}if(18==e.length){var i=e.substring(6,10),r=e.substring(10,12),a=e.substring(12,14),n=e.substring(14,17),s=new Date(i,parseFloat(r)-1,parseFloat(a));if(s.getFullYear()!=parseFloat(i)||s.getMonth()!=parseFloat(r)-1||s.getDate()!=parseFloat(a))return t.isTrue=!1,t;var o=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2,1],c=[1,0,10,9,8,7,6,5,4,3,2],l=0,d=e.split("");"x"==d[17].toLowerCase()&&(d[17]=10);for(var u=0;17>u;u++)l+=o[u]*d[u];var u=l%11;return d[17]!=c[u]?t.isTrue=!1:(t.isTrue=!0,t.year=s.getFullYear(),t.month=s.getMonth()+1,t.day=s.getDate(),0==n%2?(t.isFemale=!0,t.isMale=!1):(t.isFemale=!1,t.isMale=!0),t)}return t}try{FastClick.attach(document.body)}catch(u){}$(".form-text-prefix").next().data("width",$(".form-text-prefix").next().width()),$(window).resize(function(){e()}),e(),$(document).on("focus","input.form-unit",function(){var e=$(this).closest(".form"),t=$(this).closest(".form-group");if($(t).find(".active").removeClass("active"),$(t).find(".tip").addClass("active"),void 0!==$(this).attr("equal")){var i=$(e).find("input[name="+$(this).attr("equal")+"]"),r=$(t).find(".equal"),a=$(i).closest(".form-group"),n=$(a).find(".active");$(a).find(".okay"),0===r.length&&n.removeClass("active")}}),t($("#regInfoForm"),!0);var h=0;$(document).on("blur","input.form-unit",function(){$(this).removeClass("form-unit-error"),$(this).closest(".form-group").find(".active").removeClass("active"),r(this)}),$(document).on("keyup","input[name=loginPwd],input[name=transPwd]",function(){s(this)}),$(document).on("click","input[type=checkbox]",function(){"required"===$(this).attr("required")&&"checked"!==$(this).attr("checked")?($(this).addClass("form-unit-error"),$(this).closest(".form-group").find(".required").addClass("active")):($(this).removeClass("form-unit-error"),$(this).closest(".form-group").find(".active").removeClass("active"))}),$(document).on("submit","#regInfoForm",function(e){e.preventDefault(),o(this)}),$(document).on("click","#reg-submit-btn.btn-primary",function(){o($(this).closest("form"))}),$(document).on("click",".secure-tips h2",function(){var e=$(this).siblings(".content");e.toggle(),$(this).find("i").css("-webkit-transform","scaleY("+(e.is(":visible")?"-1":"1")+")"),$("html,body").animate({scrollTop:$(this).offset().top+150},"medium",function(){})})});